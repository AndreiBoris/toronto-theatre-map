var ko=ko||{},google=google||{},mapManager=mapManager||{},twttr=twttr||{},TheatreMapViewModel=function(){"use strict";var e=this;e.twitterListMode=ko.observable(!0),e.markers=ko.observableArray([]),e.infoWindowsContent=ko.observableArray([]),e.activeTwitter=ko.observable(""),e.twitterIsOpen=ko.observable(!0),e.twitterListNotLoaded=ko.observable(!0),e.crazyArray=ko.observableArray([]),e.filterDiverse=ko.observable(!1),e.filterWomen=ko.observable(!1),e.filterQueer=ko.observable(!1),e.filterAlternative=ko.observable(!1),e.filterCommunity=ko.observable(!1),e.filterAboriginal=ko.observable(!1),e.filterInternational=ko.observable(!1),e.filterAsian=ko.observable(!1),e.filterChildren=ko.observable(!1),e.filterLatin=ko.observable(!1),e.filterTechnology=ko.observable(!1),e.filterBlack=ko.observable(!1),e.filterOffice=ko.observable(!1),e.filterVenue=ko.observable(!1),e.filters=[{filter:e.filterDiverse,flag:"diverse"},{filter:e.filterWomen,flag:"women"},{filter:e.filterQueer,flag:"queer"},{filter:e.filterAlternative,flag:"alternative"},{filter:e.filterCommunity,flag:"community"},{filter:e.filterAboriginal,flag:"aboriginal"},{filter:e.filterInternational,flag:"international"},{filter:e.filterAsian,flag:"asian"},{filter:e.filterChildren,flag:"children"},{filter:e.filterLatin,flag:"latin"},{filter:e.filterTechnology,flag:"technology"},{filter:e.filterBlack,flag:"black"},{filter:e.filterOffice,flag:"office"},{filter:e.filterVenue,flag:"venue"}],e.ready=ko.observable(!1),e.sortedAlpha=!1,e.sortedFounded=!1,e.filter=ko.computed(function(){var t,a,i,o=e.markers().length,n=e.filters.length;for(t=0;o>t&&e.ready();t++)for(i=e.markers()[t],mapManager.util.showItem(i),a=0;n>a&&(!e.filters[a].filter()||!mapManager.util.itemFailsFilter(i,e.filters[a].flag));a++);}),e.clearFilters=function(){var t,a=e.filters.length;for(t=0;a>t;t++)e.filters[t].filter(!1)},e.flipTwitter=function(){e.twitterListMode(!e.twitterListMode())},e.newTwitterFeed=ko.computed(function(){!e.twitterListMode()&&e.twitterIsOpen()&&(console.log("Eating resources"),document.getElementById("twitter-account").innerHTML="",twttr.widgets.createTimeline("694221648225001472",document.getElementById("twitter-account"),{screenName:e.activeTwitter(),tweetLimit:5}))}),e.twitterListFeed=ko.computed(function(){if(e.twitterListNotLoaded()&&e.twitterListMode()&&e.twitterIsOpen()){var t=screen.height;console.log(t),e.twitterListNotLoaded(!1),console.log("making the list for the only time"),twttr.widgets.createTimeline("694233158955323392",document.getElementById("twitter-list"),{listOwnerScreenName:"BreathMachine",listSlug:"toronto-theatre",tweetLimit:10}),document.getElementById("twitter-div").style.height=t,document.getElementById("twitter-list").style.height=t}});var t=function(t){t.addListener("click",function(){e.openInfoWindow(t),e.activeTwitter(t.twitterHandle)})};e.openInfoWindow=function(t){e.closeInfoWindows(),t.infoWin.open(mapManager.map,t)},e.closeInfoWindows=function(){e.markers().forEach(function(e){e.infoWin.close()})},e.printSomething=function(){console.log(e.infoWindowsContent())},e.moveMarker=function(){e.openInfoWindow(0)},e.sortListAlpha=function(){e.resetSorts("sortedAlpha"),e.sortedAlpha?(e.sortedAlpha=!1,e.markers.sort(mapManager.util.alphabeticalSortReverse)):(e.sortedAlpha=!0,e.markers.sort(mapManager.util.alphabeticalSort))},e.sortListFounding=function(){e.resetSorts("sortedFounded"),e.sortedFounded?(e.sortedFounded=!1,e.markers.sort(mapManager.util.foundingSortReverse)):(e.sortedFounded=!0,e.markers.sort(mapManager.util.foundingSort))},e.resetSorts=function(t){var a=e[t];e.sortedFounded=!1,e.sortedAlpha=!1,e[t]=a},e.remoteAccess=function(t){e.openInfoWindow(t),e.activeTwitter(t.twitterHandle)},e.addMarkers=function(){var a;mapManager.markerData.forEach(function(i,o){e.markers.push(new google.maps.Marker({position:mapManager.util.nullPosition,map:mapManager.map,title:i.title,twitterHandle:i.twitter,index:o,icon:i.icon,type:i.type,listed:ko.observable(!0),founded:i.founded,flags:i.flags,infoWin:{}})),i.position?e.markers()[o].setPosition(i.position):i.address?mapManager.mapPositionAJAX(i.address,e.markers(),o):e.markers()[o].setMap(null),a=new google.maps.InfoWindow(mapManager.util.blankInfoWin),e.markers()[o].infoWin=a,t(e.markers()[o]);var n=e.markers()[o].infoWin,r=i.title,s=i.website,l=i.blurb;r&&s&&l?mapManager.infoWindowMaker(n,r,s,l):r?mapManager.infoWinWikiAJAX(r,e.markers(),o):mapManager.infoWindowMaker(n,r,s,l)}),e.sortListAlpha(),mapManager.store(),e.ready(!0)}},tmvm=new TheatreMapViewModel;ko.applyBindings(tmvm);var google=google||{},tmvm=tmvm||{},mapManager={initMap:function(){"use strict";var e={lat:43.657899,lng:-79.3782433};this.map=new google.maps.Map(document.getElementById("map"),{center:e,scrollwheel:!0,zoom:12,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_BOTTOM}}),tmvm.addMarkers()},infoWinWikiAJAX:function(e,t,a){"use strict";var i=this,o=e.replace(/ /g,"_"),n="https://en.wikipedia.org/w/api.php?action=opensearch&format=json&search="+o+"&limit=1&redirects=resolve",r=setTimeout(function(){t[a].infoWin.setContent(i.markerData[a].content)},5e3);$.ajax({url:n,dataType:"jsonp",success:function(o){clearTimeout(r);var n,s,l=o[1].length,d=t[a].infoWin;l?(n=o[3][0],s=o[2][0]):(n=i.markerData[a].website,s=i.markerData[a].blurb),i.infoWindowMaker(d,e,n,s)}})},mapPositionAJAX:function(e,t,a){"use strict";var i=this,o=e.replace(/ /g,"+"),n="https://maps.googleapis.com/maps/api/geocode/json?address="+o+"&bounds=43.573936,-79.560076|43.758672,-79.275135&key=AIzaSyA4SAawmy-oEMzdWboD0iHk9gDmmjb61o4";$.getJSON(n,function(e){var o=e.results[0].geometry.location.lat,n=e.results[0].geometry.location.lng;t[a].setPosition(new google.maps.LatLng(o,n)),i.markerData[a].position={lat:o,lng:n}}).error(function(o){console.log("We experienced a failure when making the coordinate request for "+e+" for the place called "+i.markerData[a].title),t[a].setMap(null)})},infoWindowMaker:function(e,t,a,i){"use strict";var o='<div class="info-window"><h4><a href="'+a+'">'+t+"</a></h4><p>"+i+"</p></div>";e.setContent(o)},store:function(){"use strict";console.log("storing data"),localStorage.markerData=JSON.stringify(this.markerData)},load:function(){"use strict";console.log("loading data"),this.markerData=[{twitter:"yyzbuddies",title:"Buddies in Bad Times Theatre",website:"http://buddiesinbadtimes.com/events/",blurb:"Buddies in Bad Times Theatre creates vital Canadian theatre by developing and presenting voices that question sexual and cultural norms. Built on the political and social principles of queer liberation, Buddies supports artists and works that reflect and advance these values. As the world’s longest-running and largest queer theatre, Buddies is uniquely positioned to develop, promote, and preserve stories and perspectives that are challenging and alternative.",address:"12 Alexander St, Toronto, ON M4Y 1B4",position:{lat:43.663346,lng:-79.383107},icon:"dist/images/museum.png",type:"venue",flags:["queer","alternative","community","venue"],founded:1978},{twitter:"tarragontheatre",title:"Tarragon Theatre",website:"http://tarragontheatre.com/now-playing/",blurb:"Tarragon Theatre’s mission is to create, develop and produce new plays and to provide the conditions for new work to thrive. To that end, the theatre engages the best theatre artists and craftspeople to interpret new work; presents each new work with high quality production values; provides an administrative structure to support new work; develops marketing strategies to promote new work; and continually generates an audience for new work.",address:"30 Bridgman Ave, Toronto, ON M5R 1X3",position:{lat:43.674842,lng:-79.41282},icon:"dist/images/museum.png",type:"venue",flags:["venue"],founded:1970},{twitter:"beyondwallsTPM",title:"Theatre Passe Muraille",website:"http://passemuraille.ca/current-season",blurb:"Theatre Passe Muraille (TPM) believes there should be a more diverse representation of artists, audience members, and stories in our theatre in Canada. TPM aspires to be a leader locally, nationally and internationally in establishing, promoting, and embracing collaborative and inclusive theatre practices that support and ignite the voices of unique artists, communities and audiences.",address:"16 Ryerson Ave, Toronto, ON M5T 2P3",position:{lat:43.648553,lng:-79.402584},icon:"dist/images/museum.png",type:"venue",flags:["diverse","venue"],founded:1968},{twitter:"FactoryToronto",title:"Factory Theatre",website:"https://www.factorytheatre.ca/what-s-on/",blurb:"From its founding in 1970 with a commitment to Canadian stories; to the Heritage building that now houses the 45-year old company; Factory's vision has always conveyed indomitable courage and resolve; toughness; tenaciousness; and strength of character. Factory has grit.",address:"125 Bathurst St, Toronto, ON M5V 2R2",position:{lat:43.645531,lng:-79.40269},icon:"dist/images/museum.png",type:"venue",flags:["venue"],founded:1970},{twitter:"StorefrontTO",title:"Storefront Theatre",website:"http://thestorefronttheatre.com/current-season/",blurb:"The Storefront Arts Initiative represents the Storefront Theatre’s management team and its commitment to the artistic independent scene in Toronto through affordable venues, groundbreaking productions, collaborative discourse and community-centric support.",address:"955 Bloor Street West, Toronto, ON M6H 1L7",position:{lat:43.661288,lng:-79.42824},icon:"dist/images/museum.png",type:"venue",flags:["venue"],founded:2013},{twitter:"NativeEarth",title:"Native Earth Performing Arts",website:"http://www.nativeearth.ca/aki-studio-theatre/",blurb:"Through stage productions (theatre, dance and multi-disciplinary art), new script development, apprenticeships and internships, Native Earth seeks to fulfill a community of artistic visions. It is a vision that is inclusive and reflective of the artistic directions of members of the Indigenous community who actively participate in the arts.",address:"585 Dundas St E #250, Toronto, ON M5A 2B7",position:{lat:43.659961,lng:-79.362607},icon:"dist/images/museum.png",type:"venue",flags:["aboriginal","community","venue"],founded:1982},{twitter:"canadianstage",title:"Berkeley Street Theatre",website:"https://nowtoronto.com/locations/berkeley-street-theatre/",blurb:"Berkeley Street Theatre is associated with the Canadian Stage Company. <br>A home for innovative live performance from Canada and around the world,<br>Where audiences encounter daring productions, guided by a strong directorial vision <br>Where theatre, dance, music and visual arts cohabit, clash, interrogate <br>Where a bold, 21st-century aesthetic reigns",address:"26 Berkeley St, Toronto",position:{lat:43.650621,lng:-79.363817},icon:"dist/images/museum.png",type:"venue",flags:["venue"],founded:1987},{twitter:"canadianstage",title:"Bluma Appel Theatre",content:"Bluma Appel Theatre",website:"https://www.canadianstage.com/Online/default.asp",blurb:"Bluma Appel Theatre is associated with the Canadian Stage Company. <br>A home for innovative live performance from Canada and around the world,<br>Where audiences encounter daring productions, guided by a strong directorial vision <br>Where theatre, dance, music and visual arts cohabit, clash, interrogate <br>Where a bold, 21st-century aesthetic reigns",address:"27 Front St E, Toronto",position:{lat:43.647414,lng:-79.375129},icon:"dist/images/museum.png",type:"venue",flags:["international","venue"],founded:1987},{twitter:"Soulpepper",title:"Soulpepper Theatre Company",website:"https://www.soulpepper.ca/performances.aspx",blurb:"Central to Soulpepper’s identity is its commitment to being a Civic Theatre - a place of belonging for artists and audiences of all ages and backgrounds. We are the largest employer of theatre artists in Toronto, and our artists live and play in this community. Our partners are our neighbours and the stories we tell are infused with our shared experiences. Soulpepper plays an intrinsic role in the cultural life of this city.",address:"50 Tank House Lane, Toronto",position:{lat:43.65086,lng:-79.357452},icon:"dist/images/museum.png",type:"venue",flags:["community","venue"],founded:1998},{twitter:"fuGENTheatre",title:"fu-GEN Theatre",website:"http://fu-gen.org/current-season/",blurb:"fu-GEN is a charitable theatre company dedicated to the development of professional Asian Canadian theatre artists through the production of new and established works.",address:"157 Carlton St #207, Toronto",position:{lat:43.663233,lng:-79.372377},icon:"dist/images/city.png",type:"office",flags:["asian","office"],founded:2002},{twitter:"CahootsTheatre",title:"Cahoots Theatre Company",website:"http://www.cahoots.ca/",blurb:"Cahoots Theatre investigates and examines thecomplexities of diversity through the creation and production of new theatre works, development of professional artists and the engagement of communities.",address:"388 Queen Street East, Unit 3, Toronto, Ontario M5A 1T3",position:{lat:43.656172,lng:-79.363262},icon:"dist/images/city.png",type:"office",flags:["diverse","community","office"],founded:1986},{twitter:"bcurrentLIVE",title:"b current",website:"http://bcurrent.ca/events/",blurb:"b current is the hotbed for culturally-rooted theatre development in Toronto.<br>Originally founded as a place for black artists to create, nurture, and present their new works, our company has grown to support artists from all diasporas. We strived over two decades to create space for diverse voices to be heard, always with a focus on engaging the communities from which our stories emerge.",address:"601 Christie St #251, Toronto, ON M6G 4C7",position:{lat:43.680006,lng:-79.4237},icon:"dist/images/city.png",type:"office",flags:["diverse","office"],founded:1991},{twitter:"Videofag",title:"videofag",website:"http://www.videofag.com/#!events/ckiy",blurb:"videofag is a storefront cinema and performance lab in toronto's kensington market dedicated to the creation and exhibition of video, film, new media, and live art.",address:"187 Augusta Avenue, Toronto, Ontario, M5T 2L4",position:{lat:43.653486,lng:-79.401357},icon:"dist/images/museum.png",type:"venue",flags:["alternative","venue"],founded:2012},{twitter:"YPTToronto",title:"Young People's Theatre",website:"http://www.youngpeoplestheatre.ca/shows-tickets/",blurb:"From the very beginning, Young Peoples Theatre established its dedication to professional productions of the highest quality – classic or contemporary – from Canada and around the world, written just for children and the people who care about them.",address:"165 Front St E, Toronto, ON M5A 3Z4, Canada",position:{lat:43.650022,lng:-79.368883},icon:"dist/images/museum.png",type:"venue",flags:["children","venue"],founded:1966},{twitter:"TheatreDirectCa",title:"Theatre Direct",website:"http://theatredirect.ca/productions/",blurb:"Our work is driven by a belief that young people deserve truth not diversion – that they have a right to meaningful cultural content and experiences. We view our audience as thinking, feeling, complex individuals – not a market and not future audiences, but our present audience of emerging citizens that demands relevant theatre that engages all their faculties, feelings and intellect.",address:"601 Christie St, Toronto, ON M6G 4C7",position:{lat:43.679979,lng:-79.424069},icon:"dist/images/city.png",type:"office",flags:["children","office"],founded:1976},{twitter:"AlunaTheatre",title:"Aluna Theatre",website:"http://www.alunatheatre.ca/current-productions/",blurb:"The artistic mission of Aluna Theatre is to embrace the myriad of voices, cultures, and stories of our population, which are transforming the landscape of Canadian theatre. In our plays, works in translation, and international co-creations, people are complex individuals who exist beyond the restrictions of cultural labels.",address:"1 Wiltshire Ave #124, Toronto, ON M6N 2V7",position:{lat:43.667751,lng:-79.449632},icon:"dist/images/city.png",type:"office",flags:["diverse","women","latin","office"],founded:2001,partners:["The Theatre Centre"]},{twitter:"TGargantua",title:"Theatre Gargantua",website:"http://theatregargantua.ca/productions/",blurb:"Each of Gargantua’s productions, while being diverse in terms of subject, writing and performance styles, melds daring physicality with striking designs, underpinned by original live music and the innovative use of technology.",address:"651 Dufferin St, Toronto, ON M6K 2B2",position:{lat:43.650239,lng:-79.431099},icon:"dist/images/city.png",type:"office",flags:["technology","office"],founded:1992},{twitter:"crowstheatre",title:"Crow's Theatre",website:"http://www.crowstheatre.com/production/in-development/",blurb:"Crow’s has a mission to ignite passionate and enduring engagement between our audiences and artists by creating, producing and promoting unforgettable theatre that examines and illuminates the pivotal narratives of our times.",address:"696 Queen St E #2C, Toronto, ON M4M 1G9",position:{lat:43.659415,lng:-79.350262},icon:"dist/images/museum.png",type:"venue",flags:["venue"],founded:1983},{twitter:"nightwoodtheat",title:"Nightwood Theatre",website:"http://www.nightwoodtheatre.net/index.php/whats_on",blurb:"Nightwood Theatre forges creative alliances among women artists from diverse backgrounds in order to develop and produce innovative Canadian Theatre. We produce original Canadian plays and works from the contemporary international repertoire.",address:"15 Case Goods Lane #306, Toronto, ON M5A 3C4",position:{lat:43.649895,lng:-79.358575},icon:"dist/images/city.png",type:"office",flags:["women","diverse","office"],founded:1979},{twitter:"obsidiantheatre",title:"Obsidian Theatre Company",website:"http://www.obsidiantheatre.com/",blurb:"Obsidian is Canada’s leading culturally diverse theatre company. Our threefold mission is to produce plays, to develop playwrights and to train emerging theatre professionals. Obsidian is passionately dedicated to the exploration, development, and production of the Black voice.",address:"1089 Dundas St E, Toronto, ON M4M 1R9",position:{lat:43.663814,lng:-79.343623},icon:"dist/images/city.png",type:"office",flags:["black","office"],founded:2e3}]}};mapManager.load();var mapManager=mapManager||{};mapManager.util=mapManager.util||{},mapManager.util.blankInfoWin={content:"",maxWidth:200},mapManager.util.nullPosition={lat:0,lng:0},mapManager.util.hideItem=function(e){"use strict";e.infoWin.close(),e.setMap(null),e.listed(!1)},mapManager.util.showItem=function(e){"use strict";e.setMap(mapManager.map),e.listed(!0)},mapManager.util.alphabeticalSort=function(e,t){"use strict";return e.title===t.title?0:e.title.toLowerCase()>t.title.toLowerCase()?1:-1},mapManager.util.alphabeticalSortReverse=function(e,t){"use strict";return e.title===t.title?0:e.title.toLowerCase()<t.title.toLowerCase()?1:-1},mapManager.util.foundingSort=function(e,t){"use strict";return e.founded===t.founded?0:e.founded>t.founded?1:-1},mapManager.util.foundingSortReverse=function(e,t){"use strict";return e.founded===t.founded?0:e.founded<t.founded?1:-1},mapManager.util.inArray=function(e,t){"use strict";var a,i=e.length;for(a=0;i>a;a++)if(e[a]===t)return!0;return!1},mapManager.util.itemFailsFilter=function(e,t){"use strict";return mapManager.util.inArray(e.flags,t)===!1?(mapManager.util.hideItem(e),!0):!1};