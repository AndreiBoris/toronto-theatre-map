var google=google||{},TheatreMapViewModel=TheatreMapViewModel||{},ko=ko||{},mapManager={initMap:function(){"use strict";var e={lat:43.657899,lng:-79.3782433};this.directionsService=new google.maps.DirectionsService,this.util.windowWidth=window.innerWidth,this.util.screenWidth=screen.width,this.map=new google.maps.Map(document.getElementById("map"),{center:e,scrollwheel:!0,zoom:12,disableDefaultUI:!0}),TheatreMapViewModel.addMarkers()},pushMarker:function(e,t){"use strict";t.push(new google.maps.Marker({position:this.util.nullPosition,map:this.map,title:e.title,twitterHandle:e.twitter,icon:e.icon,listed:ko.observable(!0),founded:e.founded,flags:e.flags,blurb:"",address:e.address}))},adjustPosition:function(e,t){"use strict";var i=t.position,o=t.address;i?e.setPosition(i):o?this.mapPositionAJAX(e,o):e.setMap(null)},setDescription:function(e,t,i,o){"use strict";t&&i&&o?(e.website=i,e.blurb=o):t?this.markerDataAjax(e,i,o):(e.website=i,e.blurb=o)},markerDataAjax:function(e,t,i){"use strict";console.log("running wiki AJAX");var o=e.title.replace(/ /g,"_"),r="https://en.wikipedia.org/w/api.php?action=opensearch&format=json&search="+o+"&limit=1&redirects=resolve",n=setTimeout(function(){e.website=t,e.blurb=i},5e3);$.ajax({url:r,dataType:"jsonp",success:function(o){clearTimeout(n);var r,a,s=o[1].length;s?(r=t?t:o[3][0],a=i?i:o[2][0]):(r=t,a=i),e.website=r,e.blurb=a}})},mapPositionAJAX:function(e,t){"use strict";var i=t.replace(/ /g,"+"),o="https://maps.googleapis.com/maps/api/geocode/json?address="+i+"&bounds=43.573936,-79.560076|43.758672,-79.275135&key=AIzaSyA4SAawmy-oEMzdWboD0iHk9gDmmjb61o4";$.getJSON(o,function(t){var i=t.results[0].geometry.location.lat,o=t.results[0].geometry.location.lng;e.setPosition(new google.maps.LatLng(i,o))}).error(function(i){console.log("We experienced a failure when making the coordinate request for "+t+" for the place called "+e.title),e.setMap(null)})},load:function(){"use strict";console.log("loading data"),this.markerData=[{twitter:"yyzbuddies",title:"Buddies in Bad Times Theatre",website:"http://buddiesinbadtimes.com/events/",blurb:"Buddies in Bad Times Theatre creates vital Canadian theatre by developing and presenting voices that question sexual and cultural norms. Built on the political and social principles of queer liberation, Buddies supports artists and works that reflect and advance these values. As the world’s longest-running and largest queer theatre, Buddies is uniquely positioned to develop, promote, and preserve stories and perspectives that are challenging and alternative.",address:"12 Alexander St, Toronto, ON M4Y 1B4",position:{lat:43.663346,lng:-79.383107},icon:"dist/images/museum.png",flags:["Queer culture","Alternative","Community focused","Theatre venue"],founded:1978},{twitter:"tarragontheatre",title:"Tarragon Theatre",website:"http://tarragontheatre.com/now-playing/",blurb:"Tarragon Theatre’s mission is to create, develop and produce new plays and to provide the conditions for new work to thrive. To that end, the theatre engages the best theatre artists and craftspeople to interpret new work; presents each new work with high quality production values; provides an administrative structure to support new work; develops marketing strategies to promote new work; and continually generates an audience for new work.",address:"30 Bridgman Ave, Toronto, ON M5R 1X3",position:{lat:43.674842,lng:-79.41282},icon:"dist/images/museum.png",flags:["Theatre venue"],founded:1970},{twitter:"beyondwallsTPM",title:"Theatre Passe Muraille",website:"http://passemuraille.ca/current-season",blurb:"Theatre Passe Muraille (TPM) believes there should be a more diverse representation of artists, audience members, and stories in our theatre in Canada. TPM aspires to be a leader locally, nationally and internationally in establishing, promoting, and embracing collaborative and inclusive theatre practices that support and ignite the voices of unique artists, communities and audiences.",address:"16 Ryerson Ave, Toronto, ON M5T 2P3",position:{lat:43.648553,lng:-79.402584},icon:"dist/images/museum.png",flags:["Diversity","Theatre venue"],founded:1968},{twitter:"FactoryToronto",title:"Factory Theatre",website:"https://www.factorytheatre.ca/what-s-on/",blurb:"From its founding in 1970 with a commitment to Canadian stories; to the Heritage building that now houses the 45-year old company; Factory's vision has always conveyed indomitable courage and resolve; toughness; tenaciousness; and strength of character. Factory has grit.",address:"125 Bathurst St, Toronto, ON M5V 2R2",position:{lat:43.645531,lng:-79.40269},icon:"dist/images/museum.png",flags:["Theatre venue"],founded:1970},{twitter:"StorefrontTO",title:"Storefront Theatre",website:"http://thestorefronttheatre.com/current-season/",blurb:"The Storefront Arts Initiative represents the Storefront Theatre’s management team and its commitment to the artistic independent scene in Toronto through affordable venues, groundbreaking productions, collaborative discourse and community-centric support.",address:"955 Bloor Street West, Toronto, ON M6H 1L7",position:{lat:43.661288,lng:-79.42824},icon:"dist/images/museum.png",flags:["Theatre venue"],founded:2013},{twitter:"NativeEarth",title:"Native Earth Performing Arts",website:"http://www.nativeearth.ca/aki-studio-theatre/",blurb:"Through stage productions (theatre, dance and multi-disciplinary art), new script development, apprenticeships and internships, Native Earth seeks to fulfill a community of artistic visions. It is a vision that is inclusive and reflective of the artistic directions of members of the Indigenous community who actively participate in the arts.",address:"585 Dundas St E #250, Toronto, ON M5A 2B7",position:{lat:43.659961,lng:-79.362607},icon:"dist/images/museum.png",flags:["Aboriginal","Community focused","Theatre venue"],founded:1982},{twitter:"canadianstage",title:"Berkeley Street Theatre",website:"https://nowtoronto.com/locations/berkeley-street-theatre/",blurb:"Berkeley Street Theatre is associated with the Canadian Stage Company.  A home for innovative live performance from Canada and around the world, Where audiences encounter daring productions, guided by a strong directorial vision Where theatre, dance, music and visual arts cohabit, clash, interrogate Where a bold, 21st-century aesthetic reigns",address:"26 Berkeley St, Toronto",position:{lat:43.650621,lng:-79.363817},icon:"dist/images/museum.png",flags:["Theatre venue"],founded:1987},{twitter:"canadianstage",title:"Bluma Appel Theatre",content:"Bluma Appel Theatre",website:"https://www.canadianstage.com/Online/default.asp",blurb:"Bluma Appel Theatre is associated with the Canadian Stage Company. A home for innovative live performance from Canada and around the world, Where audiences encounter daring productions, guided by a strong directorial vision Where theatre, dance, music and visual arts cohabit, clash, interrogate Where a bold, 21st-century aesthetic reigns",address:"27 Front St E, Toronto",position:{lat:43.647414,lng:-79.375129},icon:"dist/images/museum.png",flags:["International","Theatre venue"],founded:1987},{twitter:"Soulpepper",title:"Soulpepper Theatre Company",website:"https://www.soulpepper.ca/performances.aspx",blurb:"Central to Soulpepper’s identity is its commitment to being a Civic Theatre - a place of belonging for artists and audiences of all ages and backgrounds. We are the largest employer of theatre artists in Toronto, and our artists live and play in this community. Our partners are our neighbours and the stories we tell are infused with our shared experiences. Soulpepper plays an intrinsic role in the cultural life of this city.",address:"50 Tank House Lane, Toronto",position:{lat:43.65086,lng:-79.357452},icon:"dist/images/museum.png",flags:["Community focused","Theatre venue"],founded:1998},{twitter:"fuGENTheatre",title:"fu-GEN Theatre",website:"http://fu-gen.org/current-season/",blurb:"fu-GEN is a charitable theatre company dedicated to the development of professional Asian Canadian theatre artists through the production of new and established works.",address:"157 Carlton St #207, Toronto",position:{lat:43.663233,lng:-79.372377},icon:"dist/images/city.png",flags:["Asian-Canadian","Company office"],founded:2002},{twitter:"CahootsTheatre",title:"Cahoots Theatre Company",website:"http://www.cahoots.ca/",blurb:"Cahoots Theatre investigates and examines thecomplexities of diversity through the creation and production of new theatre works, development of professional artists and the engagement of communities.",address:"388 Queen Street East, Unit 3, Toronto, Ontario M5A 1T3",position:{lat:43.656172,lng:-79.363262},icon:"dist/images/city.png",flags:["Diversity","Community focused","Company office"],founded:1986},{twitter:"bcurrentLIVE",title:"b current",website:"http://bcurrent.ca/events/",blurb:"b current is the hotbed for culturally-rooted theatre development in Toronto. Originally founded as a place for black artists to create, nurture, and present their new works, our company has grown to support artists from all diasporas. We strived over two decades to create space for diverse voices to be heard, always with a focus on engaging the communities from which our stories emerge.",address:"601 Christie St #251, Toronto, ON M6G 4C7",position:{lat:43.680006,lng:-79.4237},icon:"dist/images/city.png",flags:["Diversity","Company office"],founded:1991},{twitter:"Videofag",title:"videofag",website:"http://www.videofag.com/#!events/ckiy",blurb:"videofag is a storefront cinema and performance lab in toronto's kensington market dedicated to the creation and exhibition of video, film, new media, and live art.",address:"187 Augusta Avenue, Toronto, Ontario, M5T 2L4",position:{lat:43.653486,lng:-79.401357},icon:"dist/images/museum.png",flags:["Alternative","Theatre venue"],founded:2012},{twitter:"YPTToronto",title:"Young People's Theatre",website:"http://www.youngpeoplestheatre.ca/shows-tickets/",blurb:"From the very beginning, Young Peoples Theatre established its dedication to professional productions of the highest quality – classic or contemporary – from Canada and around the world, written just for children and the people who care about them.",address:"165 Front St E, Toronto, ON M5A 3Z4, Canada",position:{lat:43.650022,lng:-79.368883},icon:"dist/images/museum.png",flags:["Theatre for children","Theatre venue"],founded:1966},{twitter:"TheatreDirectCa",title:"Theatre Direct",website:"http://theatredirect.ca/productions/",blurb:"Our work is driven by a belief that young people deserve truth not diversion – that they have a right to meaningful cultural content and experiences. We view our audience as thinking, feeling, complex individuals – not a market and not future audiences, but our present audience of emerging citizens that demands relevant theatre that engages all their faculties, feelings and intellect.",address:"601 Christie St, Toronto, ON M6G 4C7",position:{lat:43.679979,lng:-79.424069},icon:"dist/images/city.png",flags:["Theatre for children","Company office"],founded:1976},{twitter:"AlunaTheatre",title:"Aluna Theatre",website:"http://www.alunatheatre.ca/current-productions/",blurb:"The artistic mission of Aluna Theatre is to embrace the myriad of voices, cultures, and stories of our population, which are transforming the landscape of Canadian theatre. In our plays, works in translation, and international co-creations, people are complex individuals who exist beyond the restrictions of cultural labels.",address:"1 Wiltshire Ave #124, Toronto, ON M6N 2V7",position:{lat:43.667751,lng:-79.449632},icon:"dist/images/city.png",flags:["Diversity","Women","Latin-Canadian","Company office"],founded:2001},{twitter:"TGargantua",title:"Theatre Gargantua",website:"http://theatregargantua.ca/productions/",blurb:"Each of Gargantua’s productions, while being diverse in terms of subject, writing and performance styles, melds daring physicality with striking designs, underpinned by original live music and the innovative use of technology.",address:"651 Dufferin St, Toronto, ON M6K 2B2",position:{lat:43.650239,lng:-79.431099},icon:"dist/images/city.png",flags:["Technology","Company office"],founded:1992},{twitter:"crowstheatre",title:"Crow's Theatre",website:"http://www.crowstheatre.com/production/in-development/",blurb:"Crow’s has a mission to ignite passionate and enduring engagement between our audiences and artists by creating, producing and promoting unforgettable theatre that examines and illuminates the pivotal narratives of our times.",address:"696 Queen St E #2C, Toronto, ON M4M 1G9",position:{lat:43.659415,lng:-79.350262},icon:"dist/images/museum.png",flags:["Theatre venue"],founded:1983},{twitter:"nightwoodtheat",title:"Nightwood Theatre",website:"http://www.nightwoodtheatre.net/index.php/whats_on",blurb:"Nightwood Theatre forges creative alliances among women artists from diverse backgrounds in order to develop and produce innovative Canadian Theatre. We produce original Canadian plays and works from the contemporary international repertoire.",address:"15 Case Goods Lane #306, Toronto, ON M5A 3C4",position:{lat:43.649895,lng:-79.358575},icon:"dist/images/city.png",flags:["Women","Diversity","Company office"],founded:1979},{twitter:"obsidiantheatre",title:"Obsidian Theatre Company",website:"http://www.obsidiantheatre.com/",blurb:"Obsidian is Canada’s leading culturally diverse theatre company. Our threefold mission is to produce plays, to develop playwrights and to train emerging theatre professionals. Obsidian is passionately dedicated to the exploration, development, and production of the Black voice.",address:"1089 Dundas St E, Toronto, ON M4M 1R9",position:{lat:43.663814,lng:-79.343623},icon:"dist/images/city.png",flags:["Black","Diversity","Company office"],founded:2e3}]}};mapManager.load();var mapManager=mapManager||{};mapManager.util=function(){"use strict";var e={blankInfoWin:{content:"",maxWidth:240},nullPosition:{lat:0,lng:0},hideItem:function(e){e.setMap(null),e.listed(!1)},showItem:function(e){e.setMap(mapManager.map),e.listed(!0)},alphabeticalSort:function(e,t){return e.title===t.title?0:e.title.toLowerCase()>t.title.toLowerCase()?1:-1},alphabeticalSortReverse:function(e,t){return e.title===t.title?0:e.title.toLowerCase()<t.title.toLowerCase()?1:-1},foundingSort:function(e,t){return e.founded===t.founded?0:e.founded>t.founded?1:-1},foundingSortReverse:function(e,t){return e.founded===t.founded?0:e.founded<t.founded?1:-1},inArray:function(e,t){var i,o=e.length;for(i=0;o>i;i++)if(e[i]===t)return!0;return!1},itemFailsFilter:function(e,t){return mapManager.util.inArray(e.flags,t)?!1:(mapManager.util.hideItem(e),!0)},repositionTabs:function(){var e=$(".twitter-tab-image"),t=$(".list-tab-image"),i=$(".filter-tab-image"),o=screen.height;console.log("The screen height is "+o),o>=600?(t.css({top:.1*o}),e.css({top:.3*o}),i.css({top:.5*o})):(t.css({top:0}),e.css({top:.4*o}),i.css({top:.7*o}))}};return e}(),mapManager.util.repositionTabs();var ko=ko||{},TheatreMapViewModel=function(e,t){"use strict";return e.$twitterErrorDiv=$("#twitter-error"),e.errorTimeoutRequest=null,e.markers=t.observableArray([]),e.listIsOpen=t.observable(!1),e.filterIsOpen=t.observable(!1),e.twitterIsOpen=t.observable(!1),e.leftDivOpen=t.observable(!1),e.$divList=$("#list-div"),e.$tabHLList=$("#list-tab-highlight"),e.$tabBackList=$("#list-tab-back"),e.$tabAllList=$(".list-tab-image"),e.$divFilter=$("#filter-div"),e.$tabHLFilter=$("#filter-tab-highlight"),e.$tabBackFilter=$("#filter-tab-back"),e.$tabAllFilter=$(".filter-tab-image"),e.$divTwitter=$("#twitter-div"),e.$tabHLTwitter=$("#twitter-tab-highlight"),e.$tabBackTwitter=$("#twitter-tab-back"),e.$tabAllTwitter=$(".twitter-tab-image"),e.twitterListView=t.observable(!0),e.currentTitle=t.observable(""),e.currentWebsite=t.observable(""),e.currentBlurb=t.observable(""),e.currentAddress=t.observable(""),e.currentDirections=t.observableArray([]),e.currentCopyrights=t.observable(""),e.currentPosition=t.observable({}),e.currentTravelDuration=t.observable(0),e.activeTwitter=t.observable(""),e.lastTwitterUser=t.observable(""),e.currentTwitterListLong=!1,e.currentTwitterUserLong=!1,e.twitterLong=t.observable(!1),e.needTwitterUserReload=t.observable(!0),e.needTwitterListReload=t.observable(!0),e.firstListLoad=!0,e.$twitterListDiv=$("#twitter-list"),e.$twitterAccountDiv=$("#twitter-account"),e.glowingTwitter=!1,e.glowingTwitterFading=!1,e.glowingTwitterOpacity=0,e.glowingList=!1,e.glowingListFading=!1,e.glowingListOpacity=0,e.glowingFilter=!1,e.glowingFilterFading=!1,e.glowingFilterOpacity=0,e.filterDiverse=t.observable(!1),e.filterWomen=t.observable(!1),e.filterBlack=t.observable(!1),e.filterAboriginal=t.observable(!1),e.filterQueer=t.observable(!1),e.filterAsian=t.observable(!1),e.filterLatin=t.observable(!1),e.filterAlternative=t.observable(!1),e.filterCommunity=t.observable(!1),e.filterInternational=t.observable(!1),e.filterChildren=t.observable(!1),e.filterTechnology=t.observable(!1),e.filterOffice=t.observable(!1),e.filterVenue=t.observable(!1),e.sortedAlpha=!1,e.sortedFounded=!1,e.currentSort=t.observable(""),e.$divInfo=$("#display-div"),e.$directionsButton=$("#direction-button"),e.showDirections=t.observable(!1),e.$leftDivOpener=$("#left-div-open-button"),e.infoWindow={},e.$creditDiv=$("#credit-div"),e.creditOn=t.observable(!1),e.$divOverlay=$("#overlay-div"),e.$buttonOverlay=$(".button-overlay"),e.$titleOverlay=$(".title-background"),e.$twitterOverlay=$(".twitter-overlay"),e.$titleToronto=$(".title-toronto"),e.$titleText=$(".title-text"),e.titleIsOn=!0,e}(TheatreMapViewModel||{},ko),mapManager=mapManager||{},google=google||{},ko=ko||{},TheatreMapViewModel=function(e,t,i,o){"use strict";return e.calcRoute=function(t){var r={origin:{lat:43.64522,lng:-79.380836},destination:t,travelMode:o.maps.TravelMode.TRANSIT};e.currentDirections.removeAll(),e.currentTravelDuration(0),i.directionsService.route(r,function(t,r){if(r===o.maps.DirectionsStatus.OK){var n=/<[^>]*>/g,a=/Destination/g;i.directionsDisplay.setDirections(t),t.routes[0].legs[0].steps.forEach(function(t,i,o){e.currentDirections.push(t.instructions),e.currentTravelDuration(e.currentTravelDuration()+parseInt(t.duration.text)),t.steps&&t.steps.forEach(function(t,i,o){if(t.instructions){var r=t.instructions.replace(n," "),s=r.replace(a,"-> Destination");e.currentDirections.push(s)}})}),e.currentCopyrights(t.routes[0].copyrights)}})},e.travelTime=t.computed(function(){if(0===e.currentTravelDuration())return"Loading directions from Google Maps. If this message persists, there might be a connection problem :(";var t=1===e.currentTravelDuration()?".":"s.",i="This route will take approximately "+e.currentTravelDuration().toString()+" minute"+t;return i}),e.toggleDirections=function(t){e.showDirections(!e.showDirections()),e.showDirections()?("infoWin"===t&&(e.closeLeftDiv(),e.closeRightDivs()),e.openDirections()):e.closeDirections()},e.toggleDirectionsDisplay=function(){e.toggleDirections()},e.toggleDirectionsInfo=function(){e.toggleDirections("infoWin")},e.openDirections=function(){e.$divInfo.addClass("direction-extention"),i.directionsDisplay=new o.maps.DirectionsRenderer,i.directionsDisplay.setMap(i.map),e.calcRoute(e.currentPosition())},e.directionText=t.computed(function(){return e.showDirections()?"Hide Directions":"Show Directions"}),e.closeDirections=function(){i.directionsDisplay&&i.directionsDisplay.setMap(null),e.$divInfo.removeClass("direction-extention")},e.moveButton=function(){$("#opened-info-window").append(e.$directionsButton)},e}(TheatreMapViewModel||{},ko,mapManager,google),ko=ko||{},mapManager=mapManager||{},google=google||{},TheatreMapViewModel=function(e,t,i,o){"use strict";return e.closeRightDivs=function(){e.listIsOpen()&&e.slideList(),e.twitterIsOpen()&&e.slideTwitter(),e.filterIsOpen()&&e.slideFilter()},e.openLeftDiv=function(){e.leftDivOpen(!0),e.$divInfo.addClass("left-div-on"),e.$divInfo.removeClass("left-div-off"),console.log("opening left div"),i.util.windowWidth<1040&&e.closeRightDivs()},e.stopGlow=function(){e.glowingTwitter||(e.glowingTwitterFading=!1,e.$tabHLTwitter.css("opacity",0),e.glowingTwitterOpacity=0),e.glowingList||(e.glowingTwitterFading=!1,e.$tabHLList.css("opacity",0),e.glowingTwitterOpacity=0),e.filterIsOpen()&&(e.glowingTwitterFading=!1,e.$tabHLFilter.css("opacity",0),e.glowingTwitterOpacity=0)},e.slideHelper=function(t,i){var o=t.toLowerCase();"off"===i?(console.log("Closing "+t),e[o+"IsOpen"](!1),e["$div"+t].addClass("right-div-off"),e["$tabAll"+t].addClass("tab-off"),e["$div"+t].removeClass("right-div-on"),e["$tabAll"+t].removeClass("tab-on"),e["$tabBack"+t].css("opacity",0)):"on"===i?(console.log("Opening "+t),e[o+"IsOpen"](!0),e.determineNeedToReload(),e["$div"+t].addClass("right-div-on"),e["$tabAll"+t].addClass("tab-on"),e["$div"+t].removeClass("right-div-off"),e["$tabAll"+t].removeClass("tab-off"),e["$tabBack"+t].css("opacity",1)):console.log("Invalid direction"+i+"passed to slideHelper")},e.slideList=function(){e.listIsOpen()?e.slideHelper("List","off"):(e.glowingList&&(e.glowingList=!1,e.stopGlow()),e.slideHelper("List","on"))},e.slideFilter=function(){e.filterIsOpen()?e.slideHelper("Filter","off"):e.slideHelper("Filter","on")},e.slideTwitter=function(){e.twitterIsOpen()?e.slideHelper("Twitter","off"):e.slideHelper("Twitter","on")},e.userTwitter=function(){e.twitterListView(!1)},e.determineNeedToReload=function(){var t=e.currentTwitterUserLong,i=e.currentTwitterListLong,o=e.twitterLong();console.log("Determining need to reload."),console.log("longList: "+i),console.log("longUser: "+t),console.log("longTwitter: "+o);var r=i&&!o||!i&&o,n=t&&!o||!t&&o;console.log("Current need to reload twitter list: "+r),console.log("Current need to reload twitter user: "+n),e.needTwitterUserReload(t&&!o||!t&&o),e.needTwitterListReload(i&&!o||!i&&o),(e.needTwitterUserReload()||e.needTwitterListReload())&&(e.glowingTwitter=!0)},e.accessMarker=function(t){console.log("Accessing marker."),console.log("The screen width is "+i.util.windowWidth),e.listIsOpen()&&i.util.windowWidth<1040&&e.slideList(),e.currentTitle(t.title),e.currentWebsite(t.website),e.currentBlurb(t.blurb),e.currentAddress(t.address),e.currentPosition(t.position),e.infoWindow.setContent(e.currentInfo()),i.map.panTo(t.getPosition()),e.openInfoWindow(t),e.moveButton(),e.titleIsOn&&(e.titleIsOn=!1,e.$titleText.addClass("fly-away")),e.showDirections()&&(e.showDirections(!1),i.directionsDisplay.setMap(null)),e.openLeftDiv(),e.activeTwitter(t.twitterHandle),e.userTwitter(),e.determineNeedToReload()},e.infoWindowBinder=function(t){t.addListener("click",function(){e.accessMarker(t)})},e.addMarkers=function(){i.markerData.forEach(function(t,o){i.pushMarker(t,e.markers);var r=e.markers()[o];i.adjustPosition(r,t),e.infoWindowBinder(r);var n=t.title,a=t.website,s=t.blurb;i.setDescription(r,n,a,s)}),e.sortListAlpha(),e.infoWindow=new o.maps.InfoWindow(i.util.blankInfoWin),e.glowingList=!1,e.pickRandomTheatre(),window.requestAnimationFrame(e.glowAnimation)},e.currentInfo=t.computed(function(){var t='<div id="opened-info-window"><span class="info-title">'+e.currentTitle()+"</span><br>"+e.currentAddress()+"<br></div>";return t}),e.pickRandomTheatre=function(){var t=e.markers().length,i=Math.floor(Math.random()*t);e.activeTwitter(e.markers()[i].twitterHandle),e.currentTitle(e.markers()[i].title),e.glowingTwitter=!1,e.stopGlow()},e}(TheatreMapViewModel||{},ko,mapManager,google),ko=ko||{},twttr=twttr||{},TheatreMapViewModel=function(e,t,i){"use strict";return e.blinkTwitterError=function(){e.errorTimeoutRequest&&clearTimeout(e.errorTimeoutRequest),e.$twitterErrorDiv.hide(),e.errorTimeoutRequest=setTimeout(function(){e.$twitterErrorDiv.show()},1500)},e.newTwitterUser=t.computed(function(){var t=e.activeTwitter()!==e.lastTwitterUser();return t&&(e.glowingTwitter=!0),console.log("We have a new twitter user? "+t),console.log(e.glowingTwitter),t}),e.toggleTwitterLength=function(){console.log("Toggling twitter length."),e.blinkTwitterError(),e.twitterLong(!e.twitterLong()),e.twitterLong()?(e.$twitterListDiv.removeClass("scroll-div"),e.$twitterAccountDiv.removeClass("scroll-div")):(e.$twitterListDiv.addClass("scroll-div"),e.$twitterAccountDiv.addClass("scroll-div")),e.determineNeedToReload()},e.switchTwitter=function(){e.blinkTwitterError(),e.twitterListView(!e.twitterListView())},e.newTwitterUserFeed=t.computed(function(){e.twitterIsOpen()&&!e.twitterListView()&&(e.needTwitterUserReload()||e.newTwitterUser())&&(e.blinkTwitterError(),e.needTwitterUserReload(!1),e.lastTwitterUser(e.activeTwitter()),console.log("LOADING NEW TWITTER USER."),console.log("Active twitter account is "+e.activeTwitter()),document.getElementById("twitter-account").innerHTML="",console.log("Inner height is "+window.innerHeight),e.twitterLong()?(e.currentTwitterUserLong=!0,i.widgets.createTimeline("694221648225001472",document.getElementById("twitter-account"),{screenName:e.activeTwitter(),height:window.innerHeight-105})):(e.currentTwitterUserLong=!1,i.widgets.createTimeline("694221648225001472",document.getElementById("twitter-account"),{screenName:e.activeTwitter(),tweetLimit:5})))}),e.newTwitterListFeed=t.computed(function(){e.twitterIsOpen()&&e.twitterListView()&&(e.firstListLoad||e.needTwitterListReload())&&(e.blinkTwitterError(),e.firstListLoad=!1,e.needTwitterListReload(!1),document.getElementById("twitter-list").innerHTML="",console.log("LOADING NEW TWITTER LIST."),console.log("Inner height is "+window.innerHeight),e.twitterLong()?(e.currentTwitterListLong=!0,i.widgets.createTimeline("694233158955323392",document.getElementById("twitter-list"),{listOwnerScreenName:"BreathMachine",listSlug:"toronto-theatre",height:window.innerHeight-70})):(e.currentTwitterListLong=!1,i.widgets.createTimeline("694233158955323392",document.getElementById("twitter-list"),{listOwnerScreenName:"BreathMachine",listSlug:"toronto-theatre",tweetLimit:10})))}),e}(TheatreMapViewModel||{},ko,twttr),ko=ko||{},mapManager=mapManager||{},TheatreMapViewModel=function(e,t,i){"use strict";return e.filters=[{filter:e.filterDiverse,flag:"Diversity"},{filter:e.filterWomen,flag:"Women"},{filter:e.filterBlack,flag:"Black"},{filter:e.filterAboriginal,flag:"Aboriginal"},{filter:e.filterQueer,flag:"Queer culture"},{filter:e.filterAsian,flag:"Asian-Canadian"},{filter:e.filterLatin,flag:"Latin-Canadian"},{filter:e.filterAlternative,flag:"Alternative"},{filter:e.filterCommunity,flag:"Community focused"},{filter:e.filterInternational,flag:"International"},{filter:e.filterChildren,flag:"Theatre for children"},{filter:e.filterTechnology,flag:"Technology"},{filter:e.filterOffice,flag:"Company office"},{filter:e.filterVenue,flag:"Theatre venue"}],e.toggleFilter=function(e){e.filter(!e.filter()),console.log(e)},e.filterClicked=t.computed(function(){var t,i=e.filters.length;for(t=0;i>t;t++)if(e.filters[t].filter())return void(e.glowingFilter=!0);e.glowingFilter=!1,e.stopGlow()}),e.clearFilters=function(){var t,i=e.filters.length;for(t=0;i>t;t++)e.filters[t].filter(!1)},e.filterMarkers=t.computed(function(){var t,o,r,n=e.markers().length,a=e.filters.length;for(e.glowingList=!0,t=0;n>t;t++)for(r=e.markers()[t],i.util.showItem(r),o=0;a>o&&(!e.filters[o].filter()||!i.util.itemFailsFilter(r,e.filters[o].flag));o++);}),e}(TheatreMapViewModel||{},ko,mapManager),ko=ko||{},TheatreMapViewModel=function(e,t){"use strict";return e.glowAnimation=function(){e.twitterIsOpen()&&e.glowingTwitter&&(console.log("Twitter is open. Stop the twitter tab from glowing."),e.glowingTwitter=!1,e.stopGlow()),e.listIsOpen()&&e.glowingList&&(console.log("List is open. Stop the list tab from glowing."),e.glowingList=!1,e.stopGlow()),e.filterIsOpen()&&e.glowingFilter&&(console.log("Filter is open. Reset the filter tab glow."),e.stopGlow()),e.glowingTwitter&&e.animateGlowTab("Twitter"),e.glowingList&&e.animateGlowTab("List"),e.glowingFilter&&!e.filterIsOpen()&&e.animateGlowTab("Filter"),window.requestAnimationFrame(e.glowAnimation)},e.animateGlowTab=function(t){e["glowing"+t+"Fading"]?(e["glowing"+t+"Opacity"]-=.01,e["$tabHL"+t].css("opacity",e["glowing"+t+"Opacity"]),e["glowing"+t+"Opacity"]<=0&&(e["glowing"+t+"Fading"]=!1)):(e["glowing"+t+"Opacity"]+=.01,e["$tabHL"+t].css("opacity",e["glowing"+t+"Opacity"]),e["glowing"+t+"Opacity"]>=1.3&&(e["glowing"+t+"Fading"]=!0))},e}(TheatreMapViewModel||{},ko),ko=ko||{},mapManager=mapManager||{},TheatreMapViewModel=function(e,t,i){"use strict";return e.sortListAlpha=function(){e.resetSorts("sortedAlpha"),e.sortedAlpha?(e.sortedAlpha=!1,e.markers.sort(i.util.alphabeticalSortReverse),e.currentSort("alpha-reverse")):(e.sortedAlpha=!0,e.markers.sort(i.util.alphabeticalSort),e.currentSort("alpha")),console.log(e.currentSort())},e.sortListFounding=function(){e.resetSorts("sortedFounded"),e.sortedFounded?(e.sortedFounded=!1,e.markers.sort(i.util.foundingSortReverse),e.currentSort("date-reverse")):(e.sortedFounded=!0,e.markers.sort(i.util.foundingSort),e.currentSort("date")),console.log(e.currentSort())},e.resetSorts=function(t){var i=e[t];e.sortedFounded=!1,e.sortedAlpha=!1,e[t]=i},e}(TheatreMapViewModel||{},ko,mapManager),mapManager=mapManager||{},ko=ko||{},TheatreMapViewModel=function(e,t,i){"use strict";return e.closeLeftDiv=function(){e.$divInfo.addClass("left-div-off"),e.$divInfo.removeClass("left-div-on"),e.leftDivOpen(!1)},e.closeMarkerInfo=function(){e.closeDirections(),e.closeLeftDiv(),e.closeInfoWindow()},e.openInfoWindow=function(t){e.infoWindow.open(i.map,t),i.map.panBy(0,-160)},e.closeInfoWindow=function(){e.infoWindow.close()},e.slideCredits=function(){e.creditOn(!e.creditOn()),console.log("going on with credits"),console.log(e.creditOn())},e.fadeDisplayDivButton=t.computed(function(){e.leftDivOpen()?e.$leftDivOpener.addClass("button-disabled"):e.$leftDivOpener.removeClass("button-disabled")}),e.detailText=t.computed(function(){return e.showDirections()?"Direction Steps":"Get Details"}),e}(TheatreMapViewModel||{},ko,mapManager),TheatreMapViewModel=TheatreMapViewModel||{},ko=ko||{},mapManager=mapManager||{},TheatreMapViewModel=function(e,t,i){"use strict";return e.openCurtain=function(){e.$buttonOverlay.addClass("overlay-off"),e.$titleOverlay.addClass("overlay-off"),e.$twitterOverlay.addClass("overlay-off"),e.$titleToronto.addClass("overlay-off"),setTimeout(function(){e.$divOverlay.addClass("overlay-off")},1e3)},e}(TheatreMapViewModel||{},ko,mapManager);ko.applyBindings(TheatreMapViewModel);