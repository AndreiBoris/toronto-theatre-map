function loadData(e,t,o){"use strict";var a=e.replace(/ /g,"_"),n="https://en.wikipedia.org/w/api.php?action=opensearch&format=json&search="+a+"&limit=1&redirects=resolve",r=setTimeout(function(){return t.infoWindows[o].setContent(mapManager.markers[o].content),!1},5e3);$.ajax({url:n,dataType:"jsonp",success:function(e){clearTimeout(r);var a=e[1].length;if(a){var n='<h4><a href="'+e[3][0]+'">'+e[1][0]+"</a></h4><p>"+e[2][0]+"</p>";t.infoWindows[o].setContent(n)}1>a&&t.infoWindows[o].setContent(mapManager.markers[o].content)}})}function initMap(){"use strict";var e={lat:43.657899,lng:-79.3782433};mapManager.map=new google.maps.Map(document.getElementById("map"),{center:e,scrollwheel:!0,zoom:12,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_CENTER}}),tmvm.addMarkers()}function initMap(){"use strict";var e={lat:43.657899,lng:-79.3782433};mapManager.map=new google.maps.Map(document.getElementById("map"),{center:e,scrollwheel:!0,zoom:12,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_CENTER}}),tmvm.addMarkers()}var ko=ko||{},google=google||{},mapManager=mapManager||{},TheatreMapViewModel=function(){"use strict";var e=this;e.searchText=ko.observable(""),e.markers=ko.observableArray([]),e.infoWindows=[],e.infoWindowsContent=ko.observableArray([]);var t,o=function(t,o){e.markers()[t].addListener("click",function(){e.infoWindows.forEach(function(e,t,o){e.close()}),o.open(mapManager.map,e.markers()[t]),console.log("Good job, you clicked on "+e.markers()[t].title)})};e.printSomething=function(){console.log(e.infoWindowsContent())},e.addMarkers=function(){mapManager.markers.forEach(function(a,n,r){e.markers.push(new google.maps.Marker({position:a.position,map:mapManager.map,title:a.title})),loadData(a.title,e,n),t=new google.maps.InfoWindow({content:"",maxWidth:150}),e.infoWindows.push(t),o(n,t)})}},tmvm=new TheatreMapViewModel;ko.applyBindings(tmvm);var google=google||{},tmvm=tmvm||{},mapManager={markers:[{position:{lat:43.663346,lng:-79.383107},title:"Buddies in Bad Times Theatre"},{position:{lat:43.674842,lng:-79.41282},title:"Tarragon Theatre"},{position:{lat:43.648553,lng:-79.402584},title:"Theatre Passe Muraille"},{position:{lat:43.645531,lng:-79.40269},title:"Factory Theatre"}]},google=google||{},tmvm=tmvm||{},mapManager={markers:[{position:{lat:43.663346,lng:-79.383107},title:"Buddies in Bad Times Theatre",content:"Buddies in Bad Times Theatre."},{position:{lat:43.674842,lng:-79.41282},title:"Tarragon Theatre",content:"Tarragon Theatre"},{position:{lat:43.648553,lng:-79.402584},title:"Theatre Passe Muraille",content:"Theatre Passe Muraille"},{position:{lat:43.645531,lng:-79.40269},title:"Factory Theatre",content:"Factory Theatre"},{position:{lat:43.661288,lng:-79.42824},title:"Storefront Theatre",content:'<a href="http://thestorefronttheatre.com/">Storefront Theatre</a><p>Storefront Theatre is an independent theatre that is home of the Red One Theatre Collective.</p>'},{position:{lat:43.659961,lng:-79.362607},title:"Native Earth Performing Arts",content:'<a href="http://www.nativeearth.ca/">Native Earth Performing Arts</a><p>Founded in 1982, it is the oldest professional Aboriginal performing arts company in Canada.</p>'}]};